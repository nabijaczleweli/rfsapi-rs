<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `rfsapi` crate."><meta name="keywords" content="rust, rustlang, rust-lang, rfsapi"><title>rfsapi - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../dark.css"><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script src="../storage.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="shortcut icon" href="../favicon.ico"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../rfsapi/index.html'><div class='logo-container'><img src='../rust-logo.png' alt='logo'></div></a><p class='location'>Crate rfsapi</p><div class="sidebar-elems"><a id='all-types' href='all.html'><p>See all rfsapi's items</p></a><div class="block items"><ul><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li></ul></div><p class='location'></p><script>window.sidebarCurrent = {name: 'rfsapi', ty: 'mod', relpath: '../'};</script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../src/rfsapi/lib.rs.html#1-388' title='goto source code'>[src]</a></span><span class='in-band'>Crate <a class="mod" href=''>rfsapi</a></span></h1><div class='docblock'><p>Raw Filesystem API for Rust — enable simpler browsing with ease</p>
<p>This library is to enable both servers and clients to use the RFSAPI,
see <a href="https://github.com/thecoshman/doh">D'Oh</a> for usage example.</p>
<!-- Update relevant sexion in README, too -->
<h1 id="format-spec" class="section-header"><a href="#format-spec">Format spec</a></h1>
<p>Requests to servers that support RFSAPI (e.g. <a href="https://crates.io/crates/https"><code>http</code></a>) can be made
by doing a GET request and setting the <code>X-Raw-Filesystem-API</code> header to <code>1</code>.</p>
<p>The header has no bearing on non-GET requests.</p>
<p>If the server supports RFSAPI, the response will have <code>X-Raw-Filesystem-API</code> header also set to <code>1</code>,
the <code>Content-Type</code> should be JSON (<code>application/json; charset=utf8</code>).</p>
<p>RFSAPI responses do <em>not</em> return file contents. Use an undecorated GET instead.</p>
<p>The response body is a JSON object of type <a href="struct.FilesetData.html"><code>FilesetData</code></a> in the following format:</p>
<pre><code class="language-json">{
  &quot;writes_supported&quot;: boolean,
  &quot;is_root&quot;: boolean,
  &quot;is_file&quot;: boolean,
  &quot;files&quot;: Array&lt;RawFileData&gt;
}
</code></pre>
<ol>
<li><code>writes_supported</code> specifies if the server supports/allows write requests like PUT or DELETE.</li>
<li><code>is_root</code> specifies whether the requested path is the root directory of the server – i.e. if there are no directories above it; <code>false</code> for all files.</li>
<li><code>is_file</code> specifies whether the requested path is a file or a directory.</li>
<li><code>files</code> is the list of files in the listing and will have only one member if <code>is_file</code> is true —
this array is not sorted in any particular order.</li>
</ol>
<p>The <a href="struct.RawFileData.html"><code>RawFileData</code></a> objects describe each individual file in a listing:</p>
<pre><code class="language-json">{
  &quot;mime_type&quot;: MIME type as string,
  &quot;name&quot;: string,
  &quot;last_modified&quot;: RFC3339 Date as string,
  &quot;size&quot;: integer,
  &quot;is_file&quot;: boolean
}
</code></pre>
<ol>
<li><code>mime_type</code> is the type of the requested entity – <code>text/plain</code> for plaintext files, <code>application/zip</code> for ZIPs, &amp;c;
<code>text/directory</code> is used for directories.</li>
<li><code>name</code> is the filename, not including the path name up to there.</li>
<li><code>last_modified</code> is the file's last modification date in <a href="https://tools.ietf.org/html/rfc3339">RFC3339</a> format
(<code>2012-02-22T07:53:18-07:00</code>, <code>2012-02-22T14:53:18.42Z</code>, &amp;c.). The time-zone is implementation-defined –
<code>http</code> always normalises to UTC.</li>
<li><code>size</code> is the file's size in bytes, or <code>0</code> for directories.</li>
<li><code>is_file</code> specifies whether the entity is a file or a directory.</li>
</ol>
<h1 id="examples" class="section-header"><a href="#examples">Examples</a></h1>
<p>Given the following tree at the root of the server, running on port 8000:</p>
<pre><code class="language-plaintext">/
├── a.txt
├── ndis2-15.6.1.zip
└── works
    └── b.txt
</code></pre>
<p>Then the metadata of a <code>curl -v -H &quot;X-Raw-Filesystem-API: 1&quot; 127.0.0.1:8000</code> invocation might look something like this:</p>
<pre><code class="language-plaintext">* Expire in 0 ms for 6 (transfer 0x55dc328b3e80)
*   Trying 127.0.0.1...
* TCP_NODELAY set
* Expire in 200 ms for 4 (transfer 0x55dc328b3e80)
* Connected to 127.0.0.1 (127.0.0.1) port 8000 (#0)
&gt; GET / HTTP/1.1
&gt; Host: 127.0.0.1:8000
&gt; User-Agent: curl/7.64.0
&gt; Accept: */*
&gt; X-Raw-Filesystem-API: 1
&gt;
&lt; HTTP/1.1 200 OK
&lt; Server: http/1.9.2
&lt; X-Raw-Filesystem-API: 1
&lt; Content-Type: application/json; charset=utf-8
&lt; Content-Length: 843
&lt; Date: Wed, 22 Apr 2020 17:46:51 GMT
&lt;
* Connection #0 to host 127.0.0.1 left intact
</code></pre>
<p>Note:</p>
<ul>
<li>The server returned <code>X-Raw-Filesystem-API: 1</code></li>
<li>The server returned <code>Content-Type: application/json; charset=utf-8</code></li>
</ul>
<p>So we can be sure that the response body will be an RFSAPI <code>FilesetData</code>:</p>
<pre><code class="language-json">{
  &quot;writes_supported&quot;: false,
  &quot;is_root&quot;: true,
  &quot;is_file&quot;: false,
  &quot;files&quot;: [
    {
      &quot;mime_type&quot;: &quot;application/zip&quot;,
      &quot;name&quot;: &quot;ndis2-15.6.1.zip&quot;,
      &quot;last_modified&quot;: &quot;2020-04-13T19:12:22.695457919Z&quot;,
      &quot;size&quot;: 31387,
      &quot;is_file&quot;: true
    },
    {
      &quot;mime_type&quot;: &quot;text/directory&quot;,
      &quot;name&quot;: &quot;works&quot;,
      &quot;last_modified&quot;: &quot;2020-04-22T13:03:33.898025702Z&quot;,
      &quot;size&quot;: 0,
      &quot;is_file&quot;: false
    },
    {
      &quot;mime_type&quot;: &quot;text/plain&quot;,
      &quot;name&quot;: &quot;a.txt&quot;,
      &quot;last_modified&quot;: &quot;2020-04-22T13:02:57.928406978Z&quot;,
      &quot;size&quot;: 7,
      &quot;is_file&quot;: true
    }
  ]
}
</code></pre>
<p>We can verify the size, for example, with <code>curl 127.0.0.1:8000/a.txt | wc -c</code>, which returns</p>
<pre><code class="language-plaintext">7
</code></pre>
<p>Say we append some data to <code>a.txt</code>, or just want to check if it was modified;
<code>curl -H &quot;X-Raw-Filesystem-API: 1&quot; 127.0.0.1:8000/a.txt</code> might give us:</p>
<pre><code class="language-json">{
  &quot;writes_supported&quot;: false,
  &quot;is_root&quot;: false,
  &quot;is_file&quot;: true,
  &quot;files&quot;: [
    {
      &quot;mime_type&quot;: &quot;text/plain&quot;,
      &quot;name&quot;: &quot;a.txt&quot;,
      &quot;last_modified&quot;: &quot;2020-04-22T17:55:18.159945230Z&quot;,
      &quot;size&quot;: 12,
      &quot;is_file&quot;: true
    }
  ]
}
</code></pre>
<p>To see inside the <code>works</code> directory we can <code>curl -H &quot;X-Raw-Filesystem-API: 1&quot; 127.0.0.1:8000/works</code>:</p>
<pre><code class="language-json">{
  &quot;writes_supported&quot;: false,
  &quot;is_root&quot;: false,
  &quot;is_file&quot;: false,
  &quot;files&quot;: [
    {
      &quot;mime_type&quot;: &quot;text/plain&quot;,
      &quot;name&quot;: &quot;b.txt&quot;,
      &quot;last_modified&quot;: &quot;2020-04-22T13:03:33.898026135Z&quot;,
      &quot;size&quot;: 13,
      &quot;is_file&quot;: true
    }
  ]
}
</code></pre>
</div><h2 id='modules' class='section-header'><a href="#modules">Modules</a></h2>
<table><tr class='module-item'><td><a class="mod" href="util/index.html" title='rfsapi::util mod'>util</a></td><td class='docblock-short'><p>Module containing various utility functions.</p>
</td></tr></table><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table><tr class='module-item'><td><a class="struct" href="struct.FilesetData.html" title='rfsapi::FilesetData struct'>FilesetData</a></td><td class='docblock-short'><p>Basic RFSAPI response returned by the server.</p>
</td></tr><tr class='module-item'><td><a class="struct" href="struct.RawFileData.html" title='rfsapi::RawFileData struct'>RawFileData</a></td><td class='docblock-short'><p>Information about a file available through RFSAPI.</p>
</td></tr><tr class='module-item'><td><a class="struct" href="struct.RawFsApiHeader.html" title='rfsapi::RawFsApiHeader struct'>RawFsApiHeader</a></td><td class='docblock-short'><p>Header to specify when doing a request for the Raw Filesystem API,
designated by &quot;X-Raw-Filesystem-API&quot;.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../";window.currentCrate = "rfsapi";</script><script src="../aliases.js"></script><script src="../main.js"></script><script defer src="../search-index.js"></script></body></html>